<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Quan Ly San Pham</title>
    <meta charset="utf-8">
    <head th:replace="common/libAdmin :: libheaderadmin"></head>
    <link rel="stylesheet" type="text/css" href="/css/style.css">
</head>
<body>
<div>
    <div th:replace="common/navbarAdmin :: headerAdmin"></div>
    <div class="d-flex">
        <div th:replace="common/navbarAdmin :: sidenavAdmin"></div>
        <div class="pt-3" style="width: calc(100% - 250px);">
            <div class="container">

                <table id="example" class="table table-bordered">
                    <thead>
                    <tr>
                        <th>Mã sản phẩm</th>
                        <th>Tên sản phẩm</th>
                        <th>Ngày nhập</th>
                        <th>Danh </th>
                        <th>Trạng thái</th>
                        <th>Thao Tac</th>
                    </tr>

                    </thead>
                    <tbody>
                    <tr th:each="d : ${dataSP}">
                        <td th:text="${d.maSanPham}"></td>
                        <td th:text="${d.tenSanPham}"></td>
                        <td th:text="${d.ngayNhap}"></td>muc
                        <td th:text="${d.danhMuc.tenDanhMuc}"></td>
                        <td th:text="${d.trangThai}"></td>
                        <td>
                            <button th:attr="onclick=|openChiTietModal('${d.id}')|" data-bs-toggle="modal" data-bs-target="#hoadonchitiet" class="edit-btn"><i class="fa fa-eye"></i></button>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <br><br>
                <div class="row">
                    <div class="col-sm-13">
                        <label class="lb-form">Ma San Pham</label>
                        <input id="hoten" class="form-control">
                        <label class="lb-form">Ten San Pham</label>
                        <input id="sdt" class="form-control">
                        <label class="lb-form">Ngay Nhap</label>
                        <input id="v" class="form-control">
                        <label class="lb-form">Trang thai</label>
                        <select id="" class="form-control">
                            <option value="Con hang">Con hang</option>
                            <option value="Het hang">Het hang</option>
                        </select>

                        <br>
                        <button onclick="" class="btn btn-primary">Them san pham</button>
                        <br><br>
                    </div>
            </div>
        </div>
    </div>
</div>
</body>

<script>
    $('#example').DataTable();
</script>
<script th:inline="javascript">
    async function openChiTietModal(sanPhamId){
        var url = '/san-pham/ctsp?idctsp='+sanPhamId
        const response = await fetch(url, {
            method: 'GET'
        });
        var result = await response.json();
        console.log(result)
        var main = '';
        for(var i=0; i< result.length; i++){
            main += `
                <tr>
                    <td>${result[i].id}</td>
                    <td>${result[i].sanPham.tenSanPham}</td>
                    <td>${result[i].mauSac.tenMau}</td>
                    <td>${result[i].size.tenSize}</td>
                    <td>${result[i].chatLieu.tenChatLieu}</td>
                    <td>${result[i].soLuong}</td>
                    <td>${formatmoney(result[i].donGia)}</td>
                    <td><button>Chon</button></td>
                </tr>
            `
        }
        document.getElementById("listctsp").innerHTML = main
    }

    function formatmoney(money) {
        const VND = new Intl.NumberFormat('vi-VN', {
            style: 'currency',
            currency: 'VND',
        });
        return VND.format(money);
    }
</script>

<div class="modal fade" id="hoadonchitiet" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="false">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header"><h5 class="modal-title" id="exampleModalLabel">San pham chi tiết</h5> <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div>
            <div class="modal-body">
                <table class="table">
                    <thead>
                    <tr>
                        <th>Ma CTSP</th>
                        <th>Ten San Pham</th>
                        <th>Mau Sac</th>
                        <th>Kich Thuoc</th>
                        <th>Chat Lieu</th>
                        <th>So Luong</th>
                        <th>Don Gia</th>
                        <th>TT</th>
                    </tr>
                    </thead>
                    <tbody id="listctsp">

                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

</html>


